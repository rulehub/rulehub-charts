# NOTE: placeholders quoted for Helm parse stability
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: block-hostpath
  annotations:
    rulehub.id: block.hostpath
spec:
  validationFailureAction: enforce
  background: true
  rules:
    - name: forbid-hostpath
      match:
        resources:
          kinds: ["Pod"]
      # Canonical pattern-based validation: ensure each volume item has no hostPath field.
      # Using foreach + pattern validates every element and avoids brittle deny/AnyIn templates.
      validate:
        message: "hostPath volumes are not allowed"
        foreach:
          - list: "request.object.spec.volumes[]"
            pattern:
              =(hostPath): null
